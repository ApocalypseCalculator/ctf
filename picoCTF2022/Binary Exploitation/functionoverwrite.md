# Function Overwrite

### Problem

Overwriting a global function pointer to get an easier checker.

### Solution

The `vuln` function first prompts the user for a string and then a number that is less than 10 and another number. Then, it increases a corresponding element's value in a global `fun` array.

Finally, the `check` function (which is actually a function pointer pointing to `hard_checker` also stored in a global variable) is called with the length of the input string. The function compares the sum of the ASCII values for the characters in the string with 13371337, giving the flag only upon equality. 

There is no buffer overflow since scanf is used. We are limited to 127 ASCII characters, each of which is at most 127. The maximum sum is therefore 127 * 127 = 16129, far below 13371337. Therefore it's not possible to win legitimately.

The observation that leads to the solution of the challenge is that although `vuln` checks if num1 < 10, it does not check if num1 >= 0. Therefore, we can supply a negative index to overwrite arbitrary values before the global `fun` array. Conveniently, we can change the address pointed to by `check` with a value such that the new pointer points to `easy_checker` (essentially the same function except the value is 1337).

Using GDB, we can determine that the index to overwrite is -16 and the value to increase by is -314. Then, we just have to make the value 1337 using ASCII characters (note that the newline is not considered).

Payload:
```python
from pwn import *

p = remote('saturn.picoctf.net', 63422)

p.send(b'z' * 10 + b'u\n')

idx = -16
offset = -314

p.send(str(idx).encode('ascii') + b' ' + str(offset).encode('ascii') + b'\n')

p.interactive()
```

Output:
```
You're 1337. Here's the flag.
picoCTF{0v3rwrit1ng_P01nt3rs_529bfb38}
```

Therefore, the flag is `picoCTF{0v3rwrit1ng_P01nt3rs_529bfb38}`.
